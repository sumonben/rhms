{% extends 'basepage/basepage.html' %}
{% load static  %}

    <!-- Page Preloder -->
    <!-- <div id="preloder">
        <div class="loader"></div>
    </div> -->

    <!-- Offcanvas Menu Section Begin -->
    
    {% block content %}
    <!-- Breadcrumb Section End -->

    <!-- Room Details Section Begin -->
     <br></br>
    <section class="room-details-section spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-8">
                    <div class="room-details-item" style="background: var(--service);">
                        <img src="{{ room.main_image.url }}" alt="">
                        <div class="rd-text" style="background: transparent;padding: 20px;">
                            <div class="rd-title">
                                <h3>{{ room.name_eng }}</h3>
                                <div class="rdt-right">
                                    <div class="rating">
                                        <i class="icon_star"></i>
                                        <i class="icon_star"></i>
                                        <i class="icon_star"></i>
                                        <i class="icon_star"></i>
                                        <i class="icon_star-half_alt"></i>
                                    </div>
                                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                                        <button id="room_{{ room.id }}" class="btn btn-primary" style="padding: 12px 24px; font-size: 16px; font-weight: 600;" onclick="addToCart( this.id )">Add To Book</button>
                                        <button class="btn btn-success" style="padding: 12px 24px; font-size: 16px; font-weight: 600; text-align: center;" onclick="bookNowSingle('room_{{ room.id }}')">Book Now</button>
                                    </div>
                                </div>
                            </div>
                            <h2>{{ room.price }}&#x09F3;<span>/Pernight</span></h2>
                            <table>
                                <tbody>
                                    <tr>
                                        <td class="r-o">Size:</td>
                                        <td>{{ room.size }} sqft</td>
                                    </tr>
                                    <tr>
                                        <td class="r-o">Capacity:</td>
                                        <td>Max persion {{ room.person_occupancy  }}</td>
                                    </tr>
                                    <tr>
                                        <td class="r-o">Bed:</td>
                                        <td>{{ room.room_type.name_eng }}</td>
                                    </tr>
                                    <tr>
                                        <td class="r-o">Services:</td>
                                        <td>{{ room.services }}</td>
                                    </tr>
                                </tbody>
                            </table>
                            <p class="f-para">
                                
                                {% if room.description %}
                                    {{ room.description }}

                                {% endif %}
                                    
                            </p>
                           
                        </div>
                    </div>
<style>
#slider {
  position: relative;
  overflow: hidden;
  margin: 20px auto 0 auto;
  border-radius: 4px;
}

#slider ul {
  position: relative;
  margin: 0;
  padding: 0;
  height: 180px;
  list-style: none;
}

#slider ul li {
  position: relative;
  display: block;
  float: left;
  margin: 0 10px;
  padding: 15px;
  width: 150px;
  height: 160px;
  background: #f5f5f5;
  text-align: center;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: transform 0.3s ease;
}

#slider ul li:hover {
  transform: translateY(-5px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

a.control_prev,
a.control_next {
  position: absolute;
  z-index: 999;
  display: block;
  padding: 15px 10px;
  width: auto;
  height: auto;
  background: #dfa974;
  color: #fff;
  text-decoration: none;
  font-weight: 600;
  font-size: 20px;
  opacity: 0.8;
  cursor: pointer;
  top: 50%;
  transform: translateY(-50%);
  border-radius: 4px;
}

a.control_prev:hover,
a.control_next:hover {
  opacity: 1;
  background: #c89d6c;
  -webkit-transition: all 0.2s ease;
}

a.control_prev {
  left: -10px;
}

a.control_next {
  right: -10px;
}

.slider_option {
  position: relative;
  margin: 10px auto;
  width: 160px;
  font-size: 18px;
}

.similar-rooms-section {
  background: #fafafa;
  padding: 25px;
  border-radius: 8px;
  border: 1px solid #e0e0e0;
}
</style>

<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

<!-- Debug: same_priced_rooms exists: {{ same_priced_rooms|length }} -->
{% if same_priced_rooms %}
<div class="similar-rooms-section" style="margin-top: 30px;">
    <h4 style="margin-bottom: 20px; color: #dfa974;">Similar Priced Rooms ({{ room.price }}&#x09F3;/night) - {{ same_priced_rooms|length }} found</h4>
    <div id="slider">
      <a href="#" class="control_next">>></a>
      <a href="#" class="control_prev"><</a>
      <ul>
        {% for similar_room in same_priced_rooms %}
        <li style="{% cycle 'background: #f0f0f0;' 'background: #e0e0e0;' %}">
            <a href="{% url 'room_details' similar_room.id %}" style="text-decoration: none; color: #333; display: block; height: 100%; padding: 10px;">
                <div style="text-align: center;">
                    {% if similar_room.main_image %}
                        <img src="{{ similar_room.main_image.url }}" alt="{{ similar_room.name_eng }}" style="width: 80px; height: 80px; object-fit: cover; border-radius: 8px; margin-bottom: 8px;">
                    {% else %}
                        <div style="width: 80px; height: 80px; background: #ddd; border-radius: 8px; margin: 0 auto 8px; display: flex; align-items: center; justify-content: center; font-size: 12px; color: #999;">No Image</div>
                    {% endif %}
                    <div style="font-size: 14px; font-weight: 600;">{{ similar_room.room_no }}</div>
                    <div style="font-size: 12px; color: #666;">{{ similar_room.name_eng }}</div>
                </div>
            </a>
        </li>
        {% endfor %}
      </ul>
    </div>
</div>
{% else %}
<!-- Debug: No similar priced rooms found or variable not set -->
{% endif %}


                    
                    <div class="rd-reviews">
                        <h4>Reviews</h4>
                        <div class="review-item">
                            <div class="ri-pic">
                                <img src="{% static 'img/room/avatar/avatar-1.jpg' %}" alt="">
                            </div>
                            <div class="ri-text">
                                <span>27 Aug 2019</span>
                                <div class="rating">
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star-half_alt"></i>
                                </div>
                                <h5>Brandon Kelley</h5>
                                <p>Neque porro qui squam est, qui dolorem ipsum quia dolor sit amet, consectetur,
                                    adipisci velit, sed quia non numquam eius modi tempora. incidunt ut labore et dolore
                                    magnam.</p>
                            </div>
                        </div>
                        <div class="review-item">
                            <div class="ri-pic">
                                <img src="{% static 'img/room/avatar/avatar-2.jpg' %}" alt="">
                            </div>
                            <div class="ri-text">
                                <span>27 Aug 2019</span>
                                <div class="rating">
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star"></i>
                                    <i class="icon_star-half_alt"></i>
                                </div>
                                <h5>Brandon Kelley</h5>
                                <p>Neque porro qui squam est, qui dolorem ipsum quia dolor sit amet, consectetur,
                                    adipisci velit, sed quia non numquam eius modi tempora. incidunt ut labore et dolore
                                    magnam.</p>
                            </div>
                        </div>
                    </div>
                    <div class="review-add">
                        <h4>Add Review</h4>
                        <form action="#" class="ra-form">
                            <div class="row">
                                <div class="col-lg-6">
                                    <input type="text" placeholder="Name*">
                                </div>
                                <div class="col-lg-6">
                                    <input type="text" placeholder="Email*">
                                </div>
                                <div class="col-lg-12">
                                    <div>
                                        <h5>You Rating:</h5>
                                        <div class="rating">
                                            <i class="icon_star"></i>
                                            <i class="icon_star"></i>
                                            <i class="icon_star"></i>
                                            <i class="icon_star"></i>
                                            <i class="icon_star-half_alt"></i>
                                        </div>
                                    </div>
                                    <textarea placeholder="Your Review"></textarea>
                                    <button type="submit">Submit Now</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="booking-form">
                        <h3>Your Reservation</h3>
                        <form action="{% url 'room_details' room.id %}" method="POST">
                            {% csrf_token %}
                            <div class="check-date">
                                <label for="date-in">Check In:</label>
                                <input type="date" class="date-input" id="date-in" name="check_in" required>
                                <i class="icon_calendar"></i>
                            </div>
                            <div class="check-date">
                                <label for="date-out">Check Out:</label>
                                <input type="date" class="date-input" id="date-out" name="check_out" required>
                                <i class="icon_calendar"></i>
                            </div>
                            <div class="select-option">
                                <label for="guest">Guests:</label>
                                <select id="guest" name="guests">
                                    <option value="1">1 Adult</option>
                                    <option value="2">2 Adults</option>
                                    <option value="3" selected>3 Adults</option>
                                    <option value="4">4 Adults</option>
                                </select>
                            </div>
                            <div class="select-option">
                                <label for="room-select">Room:</label>
                                <select id="room-select" name="rooms">
                                    <option value="1" selected>1 Room</option>
                                    <option value="2">2 Rooms</option>
                                </select>
                            </div>
                            <button type="submit">Check Availability</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Room Details Section End -->
    <script>
jQuery(document).ready(function($) {
  var slider = $('#slider');
  
  if (slider.length && slider.find('ul li').length > 0) {
    var slideCount = slider.find('ul li').length;
    var slideWidth = 170; // Fixed width including margin
    var slideHeight = 180;
    var visibleSlides = Math.min(4, slideCount); // Show max 4 slides or less if not enough
    var sliderUlWidth = slideCount * slideWidth;

    slider.css({
      width: slideWidth * visibleSlides,
      height: slideHeight
    });

    // Only apply carousel logic if we have more slides than visible
    if (slideCount > visibleSlides) {
      slider.find('ul').css({
        width: sliderUlWidth,
        marginLeft: -slideWidth,
        position: 'relative',
        left: 0
      });

      slider.find('ul li:last-child').prependTo(slider.find('ul'));

      function moveLeft() {
        slider.find('ul').stop(true, false).animate({
          left: +slideWidth
        }, 400, function() {
          slider.find('ul li:last-child').prependTo(slider.find('ul'));
          slider.find('ul').css('left', 0);
        });
      }

      function moveRight() {
        slider.find('ul').stop(true, false).animate({
          left: -slideWidth
        }, 400, function() {
          slider.find('ul li:first-child').appendTo(slider.find('ul'));
          slider.find('ul').css('left', 0);
        });
      }

      $('a.control_prev').click(function(e) {
        e.preventDefault();
        moveLeft();
      });

      $('a.control_next').click(function(e) {
        e.preventDefault();
        moveRight();
      });
    } else {
      // Just display items normally without carousel
      slider.find('ul').css({
        width: sliderUlWidth,
        marginLeft: 0,
        position: 'relative',
        left: 0
      });
      
      // Hide controls if not enough slides
      $('.control_prev, .control_next').hide();
    }
  }
});
    </script>
    {% endblock content %}
