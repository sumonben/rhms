    <!DOCTYPE html>
    <html lang="en">
    {% load static  %}
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="cache-control" content="no-cache">
        <meta name="publisher" content="Hotel Red Rock, Joypurhat">
        <meta name="copyright" content="Hotel Red Rock, Joypurhat">
        <meta name="author" content="Design/Developed by: Tarique Sumon :: Hotel Red Rock, Joypurhat">
        <meta name="robots" content="index, follow">
        <meta name="description" content="Hotel Red Rock is a luxury residential hotel in Joypurhat, Bangladesh. Book your stay with comfortable rooms, excellent amenities, and warm hospitality.">
        <meta name="keywords" content="hotel in joypurhat, Hotel Red Rock, joypurhat hotels, residential hotel, luxury accommodation, booking">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <meta property="og:title" content="Hotel Red Rock - Luxury Hotel in Joypurhat, Bangladesh">
        <meta property="og:description" content="Experience comfort and luxury at Hotel Red Rock. Book your stay in Joypurhat with modern amenities and excellent service.">
        <meta property="og:image" content="{{ LOGO.url }}">
        <meta property="og:url" content="{{ request.build_absolute_uri }}">
        <meta property="og:type" content="website">
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="Hotel Red Rock - Luxury Hotel in Joypurhat, Bangladesh">
        <meta name="twitter:description" content="Book your stay at Hotel Red Rock in Joypurhat. Luxury accommodations, excellent service, and modern amenities await you.">
        <title>Hotel Red Rock - Luxury Hotel in Joypurhat, Bangladesh</title>
        <link rel="canonical" href="{{ request.build_absolute_uri }}">
        <link rel="icon" href="{{ LOGO.url }}" type="image/x-icon">

        <!-- Google Font -->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Cabin:400,500,600,700&display=swap" rel="stylesheet">
        <!-- <link rel="stylesheet" href="{% static 'css/ecom/index.css' %}" type="text/css"> -->
        <!-- <link rel="stylesheet" href="{% static 'css/ecom/index2.css' %}" type="text/css"> -->
        <link rel="stylesheet" href="{% static 'css/ecom/main.3ffe20f2.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/ecom/monami.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/ecom/override.css' %}" type="text/css">


        <!-- Css Styles -->
        <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/font-awesome.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/elegant-icons.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/flaticon.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/owl.carousel.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/nice-select.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/jquery-ui.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/magnific-popup.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/slicknav.min.css' %}" type="text/css">
        <link rel="stylesheet" href="{% static 'css/style.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/responsive.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/mobile-enhancements.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/booking-form-enhanced.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/dropdown-fix.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/footer-compact.css' %}" type="text/css">    <link rel="stylesheet" href="{% static 'css/print-styles.css' %}" type="text/css" media="print">
        
        <!-- Schema.org Structured Data -->
        <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Hotel",
            "name": "Hotel Red Rock",
            "description": "A luxury residential hotel in Joypurhat, Bangladesh with comfortable rooms and excellent amenities.",
            "address": {
                "@type": "PostalAddress",
                "streetAddress": "Joypurhat",
                "addressLocality": "Joypurhat",
                "addressRegion": "Joypurhat",
                "postalCode": "",
                "addressCountry": "BD"
            },
            "telephone": "01786272762",
            "email": "hotelredrock3@gmail.com",
            "image": "{{ LOGO.url }}",
            "url": "{{ request.build_absolute_uri }}",
            "priceRange": "$",
            "rating": {
                "@type": "AggregateRating",
                "ratingValue": "4.5",
                "bestRating": "5",
                "worstRating": "1",
                "ratingCount": "50"
            }
        }
        </script>

        <style>
            .cart-box{
                background-color: brown;
            }
            .chatbot-launcher{
                position: fixed;
                right: 20px;
                bottom: 20px;
                background: #1e88e5;
                color: #fff;
                border: none;
                border-radius: 50px;
                padding: 12px 18px;
                box-shadow: 0 8px 20px rgba(0,0,0,0.2);
                cursor: pointer;
                z-index: 9999;
                font-weight: 600;
            }
            .chatbot-panel{
                position: fixed;
                right: 20px;
                bottom: 80px;
                width: 340px;
                max-height: 60vh;
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 12px 30px rgba(0,0,0,0.2);
                display: none;
                flex-direction: column;
                overflow: hidden;
                z-index: 9999;
            }
            .chatbot-header{
                background: #1e88e5;
                color: #fff;
                padding: 12px 14px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-weight: 600;
            }
            .chatbot-messages{
                padding: 12px;
                overflow-y: auto;
                background: #f7f7f7;
                flex: 1;
            }
            .chatbot-message{
                margin-bottom: 10px;
                padding: 8px 10px;
                border-radius: 8px;
                font-size: 14px;
                line-height: 1.4;
            }
            .chatbot-message.user{
                background: #e3f2fd;
                align-self: flex-end;
            }
            .chatbot-message.bot{
                background: #fff;
                border: 1px solid #e0e0e0;
            }
            .chatbot-input{
                display: flex;
                gap: 8px;
                padding: 10px;
                border-top: 1px solid #eee;
                background: #fff;
            }
            .chatbot-input input{
                flex: 1;
                border: 1px solid #ddd;
                border-radius: 6px;
                padding: 8px;
            }
            .chatbot-input button{
                background: #1e88e5;
                color: #fff;
                border: none;
                border-radius: 6px;
                padding: 8px 12px;
                cursor: pointer;
            }
            :root{
      --weather: {{ color.weather }};
      --body: {{ color.body }};
      --weather: {{ color.weather }};
      --service:{{ color.service }};
      --card:{{ color.card }};
      --heading:{{ color.heading }};
      --sub_heading:{{ color.sub_heading }};
      --navitem:{{ color.navitem}};
      --navbar_collaps:{{ color.navbar_collaps}};
      --member_registration:{{ color.member_registration}};
      --internal:{{ color.internal}};
      --other_text:{{ color.other_text}};
      --main_body_bg: {{ certificate_type.main_body_bg }};
      --header_bg: {{ certificate_type.header_bg }};
      --title_bg: {{ certificate_type.title_bg }};
      --body_bg:{{ certificate_type.body_bg }};
      --heading_color:{{ certificate_type.heading_color }};
      --subheading_color:{{ certificate_type.subheading_color }};
      --title_color:{{ certificate_type.title_color}};
      
      }

        </style>
    </head>

    <body>
        <!-- Page Preloder -->
        <!-- <div id="preloder">
            <div class="loader"></div>
        </div> -->
    {% include 'components/navbarfront.html' %}

        {% if messages %}
            <div class="container" style="margin-top: 15px;">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

    {% block content %}
        
    {% endblock content %}
        
        <!-- Blog Section End -->

        <!-- Footer Section Begin -->
        <footer class="footer-section" style="background: var(--card)">
            <div class="container">
                <div class="footer-text">
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="ft-about">
                                    <a href="#" style="text-align: center;">
                                        <img src="{{ LOGO.url }}" alt="" height="80px" width="80px" style="margin-auto">
                                    </a>
                                <p>{{ SLOGAN_ENG}}<br /> </p>
                                <div class="fa-social">
                                    <a href="https://www.facebook.com/p/Hotel-Red-Rock-Joypurhat-61554155192749/" target="_blank"><i class="fa fa-facebook"></i></a>
                                    <a href="https://www.facebook.com/p/Hotel-Red-Rock-Joypurhat-61554155192749/" target="_blank" ><i class="fa fa-twitter"></i></a>
                                    <a href="https://www.facebook.com/p/Hotel-Red-Rock-Joypurhat-61554155192749/" target="_blank"><i class="fa fa-tripadvisor"></i></a>
                                    <a href="https://www.facebook.com/p/Hotel-Red-Rock-Joypurhat-61554155192749/" target="_blank"><i class="fa fa-instagram"></i></a>
                                    <a href="https://www.facebook.com/watch/?v=929621535616302" target="_blank"><i class="fa fa-youtube-play"></i></a>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3 offset-lg-1">
                            <div class="ft-contact">
                                <h6>Contact Us</h6>
                                <ul>
                                    <li>01786272762</li>
                                    <li>hotelredrock3@gmail.com</li>
                                    <li></li>
                                </ul>
                            </div>
                            <div class="col-lg-7">
                            <ul>
                                <li><a href="#">Terms and Conditions</a></li>
                                <li><a href="#">Privacy Policy</a></li>
                                <li><a href="#">Our Policy</a></li>
                            </ul>
                        </div>
                        </div>
                        <div class="col-lg-3 offset-lg-1">
                            <div class="ft-newslatter">
                                <h6>New latest</h6>
                                <p>Get the latest updates and offers.</p>
                                <form action="#" class="fn-form">
                                    <input type="text" placeholder="Email">
                                    <button type="submit"><i class="fa fa-send"></i></button>
                                </form>
                            <div class="co-text"><p><!-- Link back to ictparkbangladesh can't be removed.  is licensed under CC BY 3.0. -->
    Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved {{ SITE_NAME_ENG }} <i class="fa fa-heart" aria-hidden="true"></i> by <a href="https://ictparkbd.com" target="_blank">ictparkbangladesh,</a>
    <!-- Link back to ictparkbangladesh can't be removed.  is licensed under CC BY 3.0. --><i class="fa fa-heart" aria-hidden="true"></i></p></div>
                        </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            
        </footer>
        <!-- Footer Section End -->

        <!-- Search model Begin -->
        <div class="search-model">
            <div class="h-100 d-flex align-items-center justify-content-center">
                <div class="search-close-switch"><i class="icon_close"></i></div>
                <form class="search-model-form">
                    <input type="text" id="search-input" placeholder="Search here.....">
                </form>
            </div>
        </div>
         <form>
                                {% csrf_token %}
                            </form>
        <!-- Search model end -->
        <div id="minicart" onclick="showShopingCart(this.id)" class="cart_box_container cart_info" style="background: var(--weather)"><div class="cart-box"><div class="cart-items text-center text-white" style="background: var(--weather)"><span id="number_of_item_mini" class="cart-count" style="color: white;">{{ cart_rooms.count }}</span><span style="color: white;">&nbsp; {% if cart_rooms.count == 1 %} Room {% else %} Rooms {% endif %}</span></div><div class="cart-bag text-center"><img src="{{ LOGO.url }}" alt="img"></div><div class="cart-amount" style="background: var(--weather)"><span>৳ </span><span class="cart-amount-span" id="mini_cart_total">{{ total_cart_amount }}</span></div></div></div>

        <div id="max_shoppnig_cart" class="cart-box-view"><div class="cart-box-inner-view"><div class="flex justify-between align-center background-secondary p-4" style="background: var(--weather)"><div class="flex flex-center gap-4"><span><i class="fa fa-home" style="font-size:24px;color:white"></i></span><strong class="car-box-title SearchFont m-0"><span id="number_of_item" class="text-white">{{ cart_rooms.count }}</span><span class="text-white"> {% if cart_rooms.count == 1 %} Room {% else %} Rooms {% endif %}</span></strong></div><div id="shoping_cart_close" onclick="showMiniCart( this.id )" class="text-bold text-white cursor-pointer px-4 py-2 border-radius-4 hover-background-warn">✖</div></div><div class="cart-body text-center"><div class="cart-table-wrap"><span>Happy Staying!! </span>
            <table  class="cart-table" style="width: 100%; font-size: 11px;">
                <tbody  id="cart_body">
                    
                    {% for room in cart_rooms %}
                        
                   <form action="{% url 'order_page'%}" method="post">  
                        {% csrf_token %}
   
                    <tr>
                        <td><input class="input_cart" name="input_{{ room.id }}" value="{{ room.id }}" hidden>
                            <img src="{{ room.main_image.url }}" alt="img">
                        </td>
                            <td class="card-title-product">
                                <a href="{% url 'room_details' room.id %}"><span class="SearchProductName SearchFont"> {{ room.name_eng }} </span>
                                </a>
                                <br><strong class="SearchPrice" style="font-size: 15px;">৳ {{ room.price }}</strong>
                            </td>
                                <td class="cart-inc-dsc" style="font-size: 13px; vertical-align: middle; padding: 8px 0px;">
                                    
                                </td>
                                <td style="vertical-align: middle;">
                                    <span class="SearchFont SearchPrice">{{ room.price }}</span>
                                </td> 
                                <td>
                                    <a class="cross_time">
                                        
                                        <i class="fa fa-times text-danger"></i>
                                    </a>
                                </td>
                            </tr>
                            
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="product_items__count__container">
                <div class="cmn-class-items-calc total__items">
                    <p>Total Items</p><span id="total_item_max_cart">{{ cart_rooms.count}}</span>
                </div>
                <div class="cmn-class-items-calc total__ammount" >
                    <p>Total Ammount</p><span id="total_amount_max_cart">{{ total_cart_amount }}</span>
                </div>
            </div>
            <div class="cart-footer" style="background: var(--weather)">
                <button class="Button_button__Poz4v false Button_warn__MR8nH flex-1" type="button" onclick="clearCart( this.id )">
                    Clear Cart
                </button>
                <a href="{% url 'order_page' %}" class="Button_button__Poz4v false false flex-1" >
                    Order Now
                </a>
                </form>
            </div>
        </div>
    </div> 
       <!-- Footer Section Begin -->
        <script>
        function showShopingCart(id){
                max_cart=document.getElementById('max_shoppnig_cart');
                max_cart.style.display='block';
        }
        function showMiniCart(id){
                max_cart=document.getElementById('minicart');
                max_cart.style.display='block';
                max_cart=document.getElementById('max_shoppnig_cart');
                max_cart.style.display='none';
        }
    </script>

    <button id="chatbot-launcher" class="chatbot-launcher" type="button">Chat with us</button>
    <div id="chatbot-panel" class="chatbot-panel">
        <div class="chatbot-header">
            <span>Hotel Assistant</span>
            <button id="chatbot-close" type="button" aria-label="Close" style="background: transparent; border: none; color: #fff; font-size: 18px;">×</button>
        </div>
        <div id="chatbot-messages" class="chatbot-messages"></div>
        <div class="chatbot-input">
            <input id="chatbot-input" type="text" placeholder="Ask about bookings, check-in, or rooms..." />
            <button id="chatbot-send" type="button">Send</button>
        </div>
    </div>

    <script>
        (function(){
            const panel = document.getElementById('chatbot-panel');
            const launcher = document.getElementById('chatbot-launcher');
            const closeBtn = document.getElementById('chatbot-close');
            const messages = document.getElementById('chatbot-messages');
            const input = document.getElementById('chatbot-input');
            const sendBtn = document.getElementById('chatbot-send');

            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            function addMessage(text, type){
                const el = document.createElement('div');
                el.className = `chatbot-message ${type}`;
                el.textContent = text;
                messages.appendChild(el);
                messages.scrollTop = messages.scrollHeight;
            }

            async function sendMessage(){
                const text = input.value.trim();
                if (!text) return;
                addMessage(text, 'user');
                input.value = '';

                try {
                    const response = await fetch('/chatbot/api/', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-CSRFToken': getCookie('csrftoken')
                        },
                        body: JSON.stringify({ message: text })
                    });
                    const data = await response.json();
                    if (response.ok && data.reply) {
                        addMessage(data.reply, 'bot');
                    } else {
                        addMessage(data.error || 'Chatbot error. Please try again.', 'bot');
                    }
                } catch (err) {
                    addMessage('Chatbot is offline. Please try later.', 'bot');
                }
            }

            launcher.addEventListener('click', function(){
                panel.style.display = 'flex';
                launcher.style.display = 'none';
                if (!messages.dataset.greeted) {
                    addMessage('Hello! How can I help you today?', 'bot');
                    messages.dataset.greeted = '1';
                }
                input.focus();
            });

            closeBtn.addEventListener('click', function(){
                panel.style.display = 'none';
                launcher.style.display = 'inline-flex';
            });

            sendBtn.addEventListener('click', sendMessage);
            input.addEventListener('keydown', function(e){
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
        })();
    </script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <script>
    function addToCart(id){
      var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
      
      //alert(division);
      var $j = jQuery.noConflict();
      url="{% url 'cart_add_room' %}";
      //alert(url);
        const words = id.split("_");
        const room_id=parseInt(words[1], 10);
        $.ajax({
        type: 'POST',
        url: "{% url 'cart_add_room' %}",  // Adjust the URL as per your project structure
        data: {"id":room_id  },
        headers: {
               'X-CSRFToken': csrfToken
           },
       
        success: function (response) {
         
            if (response.status === 'success') {
                // alert("sumon");
               
                number_of_item_mini=document.getElementById('number_of_item_mini');
                number_of_item_mini.innerHTML=response.rooms.length;
                number_of_item=document.getElementById('number_of_item');
                number_of_item.innerHTML=response.rooms.length;
                mini_cart_total=document.getElementById('mini_cart_total');
                mini_cart_total.innerHTML=response.total;
                total_item_max_cart=document.getElementById('total_item_max_cart');
                total_item_max_cart.innerHTML=response.rooms.length;
                total_amount_max_cart=document.getElementById('total_amount_max_cart');
                total_amount_max_cart.innerHTML=response.total;
                // cart_body=document.getElementById('cart_body');
                // cart_body=cart_body.innerHTML;
                const table = document.getElementById('cart_body');
                    table.innerHTML="";
                    // Assuming the table has a tbody, get a reference to it
                    const tbody = table.querySelector('tbody');
                for(var i=0; i<response.rooms.length;i++){
                    
                const targetElement = document.getElementById('cart_body'); // Select the target container
                const newHtml = '<tr><td><input class="input_cart" name="input_'+response.rooms[i].id+'" value="'+response.rooms[i].id+'" hidden><img src="/media/'+ response.rooms[i].main_image +'" alt="img"></td><td class="card-title-product"><a href="/Product/Details/dormicum-75-mg-tab-382a1db1ff51-59a9-5114-9cca-fe7cd0b6"><span class="SearchProductName SearchFont">'+ response.rooms[i].name_eng +', '+ response.rooms[i].room_no+'</span></a><br><strong class="SearchPrice" style="font-size: 15px;">৳  '+response.rooms[i].price+' </strong></td><td style="vertical-align: middle;"><span class="SearchFont SearchPrice">'+ response.rooms[i].price+'</span></td><td><a class="cross_time"><i class="fa fa-times text-danger"></i></a></td></tr>';
              //"/static/images/hsc-2024-25/"+response.student[0].class_roll+".jpg";

                // "beforeend" inserts the new HTML just before the closing tag of the target element
                targetElement.insertAdjacentHTML('beforeend', newHtml);
                    
                }
                alert("New Room added");

            
            } else {
             ///alert("Success message not found");
                    
                }
                
        },
        error: function (xhr, status, error) {
           
            // var err = eval("(" + xhr.responseText + ")");
            // alert(err.Message);
        }
    });
  
      
    } 


    function clearCart(id){
      var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
      
      //alert(division);
      var $j = jQuery.noConflict();
      url="{% url 'cart_clear' %}";
      //alert(url);
      
        $.ajax({
        type: 'POST',
        url: "{% url 'cart_clear' %}",  // Adjust the URL as per your project structure
        data: {"id": 2 },
        headers: {
               'X-CSRFToken': csrfToken
           },
       
        success: function (response) {
         
             //document.getElementById("student_form").reset();
            if (response.status === 'success') {
                const targetElement = document.getElementById('cart_body'); // Select the target container
                targetElement.innerHTML=""; 
                number_of_item_mini=document.getElementById('number_of_item_mini');
                number_of_item_mini.innerHTML=0;
                number_of_item=document.getElementById('number_of_item');
                number_of_item.innerHTML=0; 
                mini_cart_total=document.getElementById('mini_cart_total');
                mini_cart_total.innerHTML=0;
                total_item_max_cart=document.getElementById('total_item_max_cart');
                total_item_max_cart.innerHTML=0;
                total_amount_max_cart=document.getElementById('total_amount_max_cart');
                total_amount_max_cart.innerHTML=0; 
             
            } else {
             ///alert("Success message not found");
                    
                }
                
        },
        error: function (xhr, status, error) {
           
            // var err = eval("(" + xhr.responseText + ")");
            // alert(err.Message);
        }
    });
  
      
    }

    function OrderCart(id){
      const  items=document.getElementsByClassName("input_cart");
      const  item_values=[];
      var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
      
      var $j = jQuery.noConflict();
      //alert(url);
      
        $.ajax({
        type: 'POST',
        url: "{% url 'order_page' %}",  // Adjust the URL as per your project structure
        data: {"items":item_values,},
        headers: {
               'X-CSRFToken': csrfToken
           },
       
        success: function (response) {
         
             //document.getElementById("student_form").reset();
            if (response.status === 'success') {
                alert(response.status);
                for(const i=0; i< response.rooms.length; i++){
                    alert(i);
                }
                // const targetElement = document.getElementById('cart_body'); // Select the target container
                // targetElement.innerHTML=""; 
                // number_of_item_mini=document.getElementById('number_of_item_mini');
                // number_of_item_mini.innerHTML=0;
                // number_of_item=document.getElementById('number_of_item');
                // number_of_item.innerHTML=0; 
                // mini_cart_total=document.getElementById('mini_cart_total');
                // mini_cart_total.innerHTML=0;
                // total_item_max_cart=document.getElementById('total_item_max_cart');
                // total_item_max_cart.innerHTML=0;
                // total_amount_max_cart=document.getElementById('total_amount_max_cart');
                // total_amount_max_cart.innerHTML=0; 
             
            } else {
             ///alert("Success message not found");
                    
                }
                
        },
        error: function (xhr, status, error) {
           
            // var err = eval("(" + xhr.responseText + ")");
            // alert(err.Message);
        }
    });
  
      
    }


    // Book Now - Clear cart and add only this room
    function bookNowSingle(id){
      var csrfToken = $('[name="csrfmiddlewaretoken"]').val();
      const words = id.split("_");
      const room_id = parseInt(words[1], 10);
      
      // First clear the cart
      $.ajax({
        type: 'POST',
        url: "{% url 'cart_clear' %}",
        data: {"id": 2 },
        headers: {
            'X-CSRFToken': csrfToken
        },
        success: function (response) {
            // After clearing, add only this room
            $.ajax({
                type: 'POST',
                url: "{% url 'cart_add_room' %}",
                data: {"id": room_id },
                headers: {
                    'X-CSRFToken': csrfToken
                },
                success: function (response) {
                    if (response.status === 'success') {
                        // Redirect to order page
                        window.location.href = "{% url 'order_page' %}";
                    }
                },
                error: function (xhr, status, error) {
                    alert('Error adding room. Please try again.');
                }
            });
        },
        error: function (xhr, status, error) {
            // If clear fails, still try to add the room
            $.ajax({
                type: 'POST',
                url: "{% url 'cart_add_room' %}",
                data: {"id": room_id },
                headers: {
                    'X-CSRFToken': csrfToken
                },
                success: function (response) {
                    if (response.status === 'success') {
                        window.location.href = "{% url 'order_page' %}";
                    }
                }
            });
        }
      });
    }


    // Handle remove individual item from cart
    $(document).on('click', '.cross_time', function(e) {
        e.preventDefault();
        const roomId = $(this).closest('tr').find('.input_cart').val();
        const csrfToken = $('[name="csrfmiddlewaretoken"]').val();
        
        if (confirm('Are you sure you want to remove this room from cart?')) {
            $.ajax({
                type: 'POST',
                url: '/cart/remove/' + roomId + '/',
                headers: {
                    'X-CSRFToken': csrfToken
                },
                success: function(response) {
                    if (response.status === 'success') {
                        // Remove the row from max-cart
                        $('input[value="' + roomId + '"]').closest('tr').fadeOut(300, function() {
                            $(this).remove();
                            
                            // Update cart counters
                            const remainingItems = $('#cart_body tr').length;
                            $('#number_of_item_mini').text(remainingItems);
                            $('#number_of_item').text(remainingItems);
                            $('#total_item_max_cart').text(remainingItems);
                            
                            // Recalculate total - you may need to adjust this based on your logic
                            let newTotal = 0;
                            $('#cart_body tr').each(function() {
                                const price = parseFloat($(this).find('.SearchPrice').last().text());
                                if (!isNaN(price)) {
                                    newTotal += price;
                                }
                            });
                            
                            $('#mini_cart_total').text(newTotal.toFixed(0));
                            $('#total_amount_max_cart').text(newTotal.toFixed(0));
                            
                            // Reload if cart is empty
                            if (remainingItems === 0) {
                                location.reload();
                            }
                        });
                    }
                },
                error: function(xhr, status, error) {
                    alert('Error removing item from cart. Please try again.');
                }
            });
        }
    });

    </script>

        <!-- Js Plugins -->
        <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
        <script src="{% static 'js/bootstrap.min.js' %}"></script>
        <script src="{% static 'js/jquery.magnific-popup.min.js' %}"></script>
        <script src="{% static 'js/jquery.nice-select.min.js' %}"></script>
        <script src="{% static 'js/jquery-ui.min.js' %}"></script>
        <script src="{% static 'js/jquery.slicknav.js' %}"></script>
        <script src="{% static 'js/owl.carousel.min.js' %}"></script>
        <script src="{% static 'js/main.js' %}"></script>
    </body>

    </html>